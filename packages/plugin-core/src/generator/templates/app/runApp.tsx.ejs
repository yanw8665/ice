
<% if (miniapp) { %>
  import renderMiniapp from './renderer/miniapp';
<% } %>

<% if (web && library === 'react') { %>
  import renderReactWeb from './renderer/reactWeb';
  import { getHistory } from './history/web';
  import RuntimeModule from './runtimeModule';
<% } %>

<% if (web && library === 'rax') { %>
  import renderRaxWeb from './renderer/raxWeb';
<% } %>


function runApp(appConfig = {}, runtimeConfig = {}) {
  <% if (miniapp) { %>
    renderMiniapp(appConfig, runtimeConfig);
  <% } %>

  <% if (web && library === 'react') { %>
    // TODO：需要收敛
    const history = getHistory(appConfig);
    appConfig.router.history = history;

    // 加载运行时模块
    const runtimeInstance = new RuntimeModule(appConfig, <%- buildConfig %>);
    function loadRuntimeModules(runtime) {
      <% if (runtimeModules.length) {%>
        <% runtimeModules.forEach((runtimeModule) => { %>
          <% if(!runtimeModule.staticModule){ %>
            runtime.loadModlue(require('<%= runtimeModule.path %>'));
          <% } %>
        <% }) %>
      <% } %>
    }
    loadRuntimeModules(runtimeInstance);
    renderReactWeb(appConfig, runtimeConfig, runtimeInstance);
  <% } %>

  <% if (web && library === 'rax') { %>
    renderRaxWeb(appConfig);
  <% } %>
}

export { runApp };
